import { Resend } from "resend";
import dotenv from "dotenv";
dotenv.config();

export const contact = async (req, res) => {
  try {
    const { name, email, message } = req.body;

    const resend = new Resend(process.env.RESEND_API_KEY);

    await resend.emails.send({
      from: "Tasklane <onboarding@resend.dev>",
      to: "tanmayprofessional576@gmail.com",
      subject: `ðŸ“©Query Received From ${name}`,
      html: `
      <div style="background-color:#0b0f1a;padding:40px 0;font-family:Arial,Helvetica,sans-serif;">
        <table width="100%" cellspacing="0" cellpadding="0" style="max-width:600px;margin:0 auto;background:#0f162b;border-radius:12px;border:1px solid rgba(255,255,255,0.08);">
          
          <tr>
            <td style="padding:24px 32px;border-bottom:1px solid rgba(255,255,255,0.08);">
              <h1 style="margin:0;font-size:22px;color:#ffffff;">
                Tasklane Â· Contact Request
              </h1>
              <p style="margin:6px 0 0;color:#9ca3af;font-size:14px;">
                A new message has been submitted from the contact form.
              </p>
            </td>
          </tr>

          <tr>
            <td style="padding:28px 32px;color:#e5e7eb;font-size:15px;line-height:1.6;">
              
              <p><strong style="color:#ffffff;">Sender Details</strong></p>

              <table width="100%" cellpadding="0" cellspacing="0" style="margin-bottom:16px;">
                <tr>
                  <td style="padding:6px 0;color:#9ca3af;">Name</td>
                  <td style="padding:6px 0;color:#ffffff;">${name}</td>
                </tr>
                <tr>
                  <td style="padding:6px 0;color:#9ca3af;">Email</td>
                  <td style="padding:6px 0;color:#60a5fa;">${email}</td>
                </tr>
              </table>

              <p style="margin:16px 0 8px;color:#9ca3af;">Message</p>
              <div style="background:#0b1222;border:1px solid rgba(255,255,255,0.08);border-radius:8px;padding:14px;color:#e5e7eb;">
                ${message}
              </div>

            </td>
          </tr>

          <tr>
            <td style="padding:20px 32px;border-top:1px solid rgba(255,255,255,0.08);text-align:center;">
              <p style="margin:0;font-size:12px;color:#9ca3af;">
                This email was automatically generated by Tasklane.
              </p>
              <p style="margin:6px 0 0;font-size:12px;color:#6b7280;">
                Â© ${new Date().getFullYear()} Tasklane. All rights reserved.
              </p>
            </td>
          </tr>

        </table>
      </div>
      `,
    });

    return res.status(200).json({ message: "Message sent successfully" });
  } catch (error) {
    console.error("Resend error:", error);
    return res.status(500).json({ message: "Failed to send message" });
  }
};
